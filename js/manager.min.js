const e=["1 - Elija un documeto Excel.","2 - Seleccione la hoja que contenga los datos para la toma de ramos, ejemplo: Asignaturas, Horarios o Profesor.","3 - Seleccione los valores de los filtros.","4 - Seleccione las caracteristicas de como se mostraran para cada horario."],t=["Completo","Progresivo","Único"],o=t,a=["Por rangos de","Todos los horarios"],s=["No","Si"],l=["Carga académica semanal","Resumen de carga académica","Resumen de carga académica en texto","Lista simple de cargas académica","Carga académica semanal con resumen de sesiones"],c=["Sin ordenar","De los más cercanos a las 8 horas","De los más cercanos a las 23 horas","De los que tienen más recreo a los que tienen menos","De los que tienen menos recreo a los que tienen más"],r=["Métricas","Métricas + Selección"],n=["Rechazadas","Aprobadas","Todos"],i=["Ninguno","Sin día libre","Con día libre"],d=["Ninguno","Sin alguna ventana","Con ventana"],$=["Ninguno","Sin máximo de asignatura","Con máximo de asignatura"],h=["rechazadas","aprobadas","todas"],u=["sin día libre","con día libre"],m=["que le falte alguna ventana","con todas las ventana"],f=["dentro del máximo de asignatura","fuera del máximo de asignatura"],v=["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],b=["Lu","Ma","Mi","Ju","Vi","Sa"],p=void 0,g=1e5,y=6e4,S="0",w="1",_="2",C=" / ",x="margen",k="",A="change",M="click",D="beforeend",E="radio",q="checkbox",z="sin definir",L="online",N="no aplica",R="primeros",I="últimos",j="selección",P="lista",O="wait",T="default",U="metricas",B="Q",H="Año",V="Período",G="Sede",Q="Escuela",F="Carrera",J="Plan",X="Tipo Plan de Estudio",Y="Jornada",Z="Nivel",K="Asignatura",W="Asignatura en malla",ee="Sección",te="Horario",oe="Docente",ae="Sala",se="Día",le="Inicia",ce="Termina",re="Start",ne="End",ie="Duración",de="Grupos",$e="Queda",he="#48a3ff",ue="#f8d7da",me="#ff0000",fe="0:00:00",ve=`${fe} - ${fe}`,be="Excel con mas datos de los nesesarios.",pe="La sección no presenta un mínimo de un horario para trabajar, por ello no podra visualizar las asignaturas en pantalla.",ge="Seleccione todos los filtros requeridos: Carrera, Jornada, Semestres y Asignaturas",ye="Debe elegir al menos una asignatura para elegir un máximo de asignatura por día.",Se="Debe seleccionar almenos una sección de cada asignatura que eligió",we="Sin cargas académicas que mostrar.",_e="No hay rangos númericos que mostrar.",Ce="No se considera el valor",xe="Mostrar carga/s académica/s seleccionada/s",ke=`Tiene que haber dado click en el botón "${xe}".`,Ae="Selecciones una carga académica que quiera ver.",Me="div_ejemplo",De="div_container",Ee="2",qe="4",ze="9",Le="10",Ne="11",Re="12",Ie="13",je="14",Pe="15",Oe="16",Te="17",Ue="18",Be="19",He="20",Ve="21",Ge="22",Qe="23",Fe="24",Je="25",Xe="26",Ye="27",Ze="28",Ke="29",We="30",et="31",tt="32",ot="33",at="34",st="35",lt="36",ct="37",rt="38",nt="39",it="40",dt="41",$t="42",ht="43",ut="44",mt="45",ft="46",vt="47",bt="48",pt="49",gt="50",yt="51",St="52",wt="53",_t="54",Ct="55",xt="56",kt="57",At="58",Mt="59",Dt="60",Et="61",qt="62",zt="63",Lt="64",Nt="65",Rt="66",It="67",jt="68",Pt="69",Ot="70",Tt="71",Ut=Symbol(),Bt={},Ht={},Vt={},Gt={},Qt={},Ft={},Jt={},Xt=()=>{let e;return{t:t=>{e===p&&(e=t)},get:()=>e,set:t=>{e=t}}},Yt=Xt(),Zt=Xt(),Kt=Xt(),Wt=Xt(),eo=Xt(),to=Xt(),oo=Xt(),ao=Xt(),so=Xt(),lo=Xt(),co=(Xt(),Xt()),ro=(Xt(),()=>{"function"!=typeof Set.prototype.isSubsetOf&&(Set.prototype.isSubsetOf=function(e){for(const t of this)if(!e.has(t))return!1;return!0}),"function"!=typeof Set.prototype.difference&&(Set.prototype.difference=function(e){const t=new Set;for(const o of this)e.has(o)||t.add(o);return t})}),no=(e,t)=>[...new Set(e.map((e=>e[t])))],io=e=>document.getElementById(e),$o=e=>document.getElementsByName(e),ho=(e,t)=>{io(e).insertAdjacentHTML(D,t)},uo=(e,t,o)=>{io(e).addEventListener(t,o)},mo=(e,t)=>{io(e).innerHTML=t},fo=e=>{mo(e,k)},vo=(e,t)=>e.hasOwnProperty(t),bo=e=>`<select multiple class="form-control" id="${e}" size="8"></select>`,po=e=>`<option>${e.sort().join("</option><option>")}</option>`,go=e=>`<h6>${e}</h6>`,yo=e=>`<div id="${e}"></div>`,So=(e,t)=>`<div class="${e}" id="${t}"></div>`,wo=(e,t,o,a,s)=>`<div class="form-check"><input class="form-check-input" type="${e}" name="${t}" id="${t}_${o}" value="${s}" ><label class="form-check-label">${a}</label></div>`,_o=(e,t)=>`Ya esta viendo las ${e} cargas académicas de la ${t}.`,Co=()=>{ao.set(p)},xo=e=>{const t=e.target.files;if(0===t.length)return void alert(`Aunque no haya seleccionado un archivo excel se mantienen los datos de ${Bt[Ut]}`);if(t.length>1)return console.warn(be);const o=t[0];Bt[Ut]=o.name;const a=new FileReader;a.onload=e=>{const t=e.target.result;Yt.set(XLSX.read(t,{type:"binary"})),Yo(1),Lo(1),Xo(0),Fs(1),Zo(0),Js(),Qa(0,0)},a.onerror=e=>{console.warn(e)},a.readAsBinaryString(o)},ko=()=>window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,Ao=e=>{const t=e?"dark":"light";var o;e&&(o="html",document.querySelector(o)).setAttribute("data-bs-theme","dark");ho(Me,`<img src="img/ejemplo ${t}.png" class="img-fluid" alt="Imagen de ejemplo del contenido que puede tener un Archibo Ecxel" >`)},Mo=()=>{const t=`<div class="mb-3"><label for="formFile" class="form-label">${go(e[0])}</label><input class="form-control" id="${Oe}" name="files[]" type="file"></div>`;mo("1",t),uo(Oe,A,xo)},Do=(ro(),Ao(ko()),(()=>{const e=So(x,"1")+So(x,Ee)+So(x,"3")+So(x,qe)+So(x,"5")+So(x,"6")+So(x,"7")+So(x,"8")+So(x,ze)+So(x,Le)+So(x,Ne)+So("p-2",Re)+So(x,Ie)+So(x,je)+So(x,Pe);ho(De,e)})(),Mo(),()=>{Eo(),qo()}),Eo=()=>{delete Vt.o},qo=()=>{delete Vt.l},zo=()=>{Vt.l=[]},Lo=t=>{if(!t)return void fo(Ee);const o=`${go(e[1])}`;mo(Ee,o),Yt.get().SheetNames.forEach(((e,t)=>{const o=wo(E,Te,t,e,e);ho(Ee,o),uo(`${Te}_${t}`,A,No)}))},No=async e=>{Jt[H]=[],Jt[V]=[],Jt[G]=[],Jt[Q]=[],Jt[F]=[],Jt[J]=[],Jt[X]=[],Jt[Y]=[],Jt[Z]=[],Jt[K]=[],Jt[W]=[],Jt[ee]=[],Jt[te]=[],Jt[oe]=[],Jt[ae]=[],Jt[se]=[],Io(e),(()=>{if(co.set(vo(Zt.get()[0],se)),!vo(Zt.get()[0],te))Yo(1),Xo(0),Fs(1),Zo(0),Js(),Qa(0,0),Co()})(),Ro(),Bo(),Xo(1)},Ro=()=>{Wt.set((()=>{let e;return e=Object.keys(Zt.get()[0]).some((e=>e===K)),e?K:W})()),eo.set(Uo())},Io=e=>{const t=e.currentTarget.value,o=Yt.get().Sheets[t],a=XLSX.utils.sheet_to_row_object_array(o);Zt.set(structuredClone(a))},jo=e=>Date.parse("1970-01-01T"+e+".000"),Po=e=>e.padStart(8,"0"),Oo=(e,t)=>{const o=Math.max(...t.filter((t=>t<=e)),-1);return{i:t.findIndex((e=>e==o))+1,$:e-o}},To=(e,t)=>{const o=t.split(" "),a=o[1],s=o[3],{h:l,u:c,m:r}=((e,t)=>{try{const o=Po(e),a=Po(t),s=jo(o),l=jo(a),c=s/y,r=l/y,n=r-c;return isNaN(n)&&console.error("Error: La duración es NaN"),{h:c,u:r,m:n}}catch(e){}})(a,s);e[le]=l,e[ce]=c,e[re]=a,e[ne]=s,e[ie]=r;const n=eo.get()(r),{i:i,$:d}=Oo(r,n);e[de]=i,e[$e]=d,((e,t)=>{t>0&&(e[B]="R")})(e,d)},Uo=()=>{let e,t=function(o){const a=[[39,79,119,159,199,239,279,319,359,399,439,479,519,559,599],[44,89,134,179,224,269,314,359,404,449,494,539,584,629,674]];for(const t of a)if(t.includes(o)){e=t;break}return t=()=>e,t(o)};return e=>t(e)},Bo=()=>{for(let e=0;e<Zt.get().length;e++){const t=Zt.get()[e];Go(t);const o=t[te];Ho(o)?t[B]="Z":Vo(t,o,e)}},Ho=e=>e==ve||e.toLowerCase()==L||e.toLowerCase()==N,Vo=(e,t,o)=>{e[B]="A";const a=e[ae],s=e[oe],l=e[se];if(t.includes(C)){Zt.get().splice(o,1);const c=a.split(C),r=s.split(C),n=l.split(C),i=t.split(C);for(let a=0;a<i.length;a++)e[ae]=c[a],e[oe]=r[a],e[se]=n[a],e[te]=i[a],To(e,t),Zt.get().splice(o,0,e)}else To(e,t)},Go=e=>{e[ae]===p&&(e[ae]=z),e[oe]===p&&(e[oe]=z),e[Z]===p&&(e[Z]=e["v"]||z)},Qo=t=>{const o=t?`<div class="row">${go(e[3])}<div class="col-12 col-md-6 col-lg-3"><h6>¿Quiere ver con color las sesiones?</h6><div id="${Ct}" class="form-check"></div></div><div class="col-12 col-md-6 col-lg-9"><div id="${At}" class="form-check"></div></div></div>`:k;mo("5",o);mo("6",t?`<div class="row"><div class="col-12 col-md-3"><h6>Dibujar:</h6><div id="${it}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>Ordenar:</h6><div id="${at}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>¿Qué mostrar?:</h6><div id="${lt}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>¿Ver por lugares o todas las cargas académica?:</h6><div id="${rt}" class="form-check"></div></div></div>`:k);mo("7",t?`<div class="row"><svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><symbol id="info-fill" fill="currentColor" viewBox="0 0 16 16"><path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/></symbol></svg><div class="alert alert-primary d-flex align-items-center" role="alert"><svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Info:"><use xlink:href="#info-fill"/></svg><div>Un <strong>horario</strong> es un bloque con hora de inicio y fin.<br>Una <strong>sección</strong> puede estar en varios días y tener varios horarios.<br>Una <strong>carga académica aprobada</strong> es aquella cuyos horarios no se superponen entre sí.</div></div><div class="col-12 col-md-3"><h6>Buscar las:</h6><div id="${bt}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>Buscar las que tienen días libres:</h6><div id="${pt}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>Buscar las que tienen ventana luego de una sección:</h6><div id="${gt}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>Buscar las que tienen máximo de asignaturas por día:</h6><div id="${yt}" class="form-check"></div><div id="${St}" class="form-check"></div></div></div>`:k),Fo(t)},Fo=e=>{mo("8",e?`<div class="row"><div class="col-12 col-md-2"><h6>Procesado:</h6><div id="${$t}" class="form-check"></div></div><div class="col-12 col-md-2"><div id="${Dt}"></div></div><div class="col-12 col-md-4"><div id="${xt}"></div></div><div class="col-12 col-md-4"><div id="${Et}"></div></div></div>`:k)},Jo=t=>{const o=t?`<div class="row">${go(e[2])}<div class="col-12 col-md-8"><h6>Carrera (requerida selección)</h6><div id="${Ge}" class="form-check"></div></div><div class="col-12 col-md-4"><h6>Jornada (recomendada selección)</h6><div id="${Fe}" class="form-check"></div></div></div><div class="row"><div class="col-12 col-md-6"><h6>Plan o malla (recomendada selección)</h6><div id="${Xe}" class="form-check"></div></div><div class="col-12 col-md-6"><h6>Semenstres (requerida selección)</h6><div id="${Ze}" class="form-check"></div></div></div><div class="row"><div class="col-12 col-md-8"><h6>Asignaturas (requerida selección)</h6><div id="${We}" class="form-check"></div></div><div class="col-12 col-md-4"><h6>Sección (selección opcional)</h6><div id="${tt}" class="form-check"></div></div></div>`:k;mo("3",o)},Xo=e=>{if(!e)return Qo(0),Jo(0),void Vs(0);Jo(1),Qo(1),Ks(),Ko(1),Wo(1),ea(1),ta(1),aa(1),sa(1),Gs(0),_a(),la(),ra(),ca(),na(),ia(),da(),$a(),ha(),ua(),ma(),va(1),ba(1),Zo(1),Fs(2),Vs(0),Js(),Ba()},Yo=e=>{mo(Le,e?`<div class="row"><div class="col-12 col-sm-12 col-md-6"><div id="${Ue}"></div></div><div class="col-12 col-sm-12 col-md-6"><div id="${qt}"></div></div></div>`:k)},Zo=e=>{mo(Ue,e?`<div class="d-grid gap-2 col-6 mx-auto"><button type="button" class="btn btn-secondary" id="${Be}">Mostrar selección</button><button type="button" class="btn btn-secondary" id="${He}">Reiniciar filtros</button><button type="button" class="btn btn-secondary" id="${Ve}">Borrar cargas académicas mostradas</button></div>`:k),e&&(uo(Be,M,(()=>{Ea()})),uo(He,M,(()=>{Xo(1)})),uo(Ve,M,(()=>{Js(),Fs(1)})))},Ko=e=>{if(1===e){const e=bo(Qe);mo(Ge,e),uo(Qe,A,(()=>{Ko(3),Do()}))}if(2!==e&&1!==e)3===e&&(xa(1),Wo(2),ea(2),ta(2),aa(2),sa(2),_a(),Fs(2),Vs(0),Js());else{const t=1===e?Zt.get():2===e?Kt.get():new Error(`${Ce} ${e}`),o=no(t,F),a=po(o);mo(Qe,a)}},Wo=e=>{if(1===e){const e=bo(Je);mo(Fe,e),uo(Je,A,(()=>{Wo(3),Do()}))}if(2!==e&&1!==e)3===e&&(xa(2),ea(2),ta(2),aa(2),sa(2),_a(),Fs(2),Vs(0),Js());else{const t=1===e?Zt.get():2===e?Kt.get():new Error(`${Ce} ${e}`),o=no(t,Y),a=po(o);mo(Je,a)}},ea=e=>{if(1===e){const e=bo(Ye);mo(Xe,e),uo(Ye,A,(()=>{ea(3),Do()}))}if(2!==e&&1!==e)3===e&&(xa(3),ta(2),aa(2),sa(2),_a(),Fs(2),Vs(0),Js());else{const t=1===e?Zt.get():2===e?Kt.get():new Error(`${Ce} ${e}`),o=no(t,J),a=po(o);mo(Ye,a)}},ta=e=>{if(1===e){const e=bo(Ke);mo(Ze,e),uo(Ke,A,(()=>{ta(3),Do()}))}if(2!==e&&1!==e)3===e&&(xa(4),aa(2),sa(2),_a(),Fs(2),Vs(0),Js());else{const t=1===e?Zt.get():2===e?Kt.get():new Error(`${Ce} ${e}`),o=no(t,Z),a=po(o);mo(Ke,a)}},oa=()=>Jt[Wt.get()],aa=e=>{if(1===e){const e=bo(et);mo(We,e),uo(et,A,(()=>{xa(5),ba(1),Fs(2),Do(),aa(3),es(1),xs(0),wa(oa())}))}if(2!==e&&1!==e)3===e&&(xa(5),sa(2),_a(),Fs(2),Vs(0),Gs(0),Js());else{const t=Wt.get(),o=1===e?Zt.get():2===e?Kt.get():new Error(`${Ce} ${e}`),a=no(o,t);to.set(a);const s=po(to.get());mo(et,s)}},sa=e=>{if(1===e){const e=bo(ot);mo(tt,e),uo(ot,A,(()=>{sa(3),Do()}))}if(2!==e&&1!==e)3===e&&(xa(6),_a(),Fs(2),Vs(0),Js());else{const t=1===e?Zt.get():2===e?Kt.get():new Error(`${Ce} ${e}`),o=no(t,ee),a=po(o);mo(ot,a)}},la=()=>{c.forEach(((e,t)=>{const o=wo(E,st,t,e,t);ho(at,o),uo(`${st}_${t}`,A,(()=>{Za(1)}))})),io(`${st}_${S}`).checked=1},ca=()=>{r.forEach(((e,t)=>{const o=wo(E,ct,t,e,t);ho(lt,o)})),io(`${ct}_${w}`).checked=1},ra=()=>{const e=wo(E,nt,0,a[0],1),t=wo(E,nt,1,a[1],0);ho(rt,`${e}<div class="form-check"><div class="dropdown"><select class="form-select" aria-label="Default select example" id="${zt}"><option value="5">5</option><option value="10">10</option><option value="25">25</option><option value="50" selected>50</option><option value="75">75</option><option value="100">100</option></select></div></div>${t}`),io(`${nt}_${S}`).checked=1},na=()=>{l.forEach(((e,t)=>{const o=wo(E,dt,t,e,t);ho(it,o)})),io(`${dt}_${S}`).checked=1},ia=()=>{o.forEach(((e,t)=>{const o=t+1,a=wo(E,ht,o,e,o);ho($t,a),uo(`${ht}_${o}`,A,(()=>{Wa(1)}))})),io(`${ht}_${o.length}`).checked=1},da=()=>{n.forEach(((e,t)=>{const o=wo(q,ut,t,e,t);ho(bt,o),uo(`${ut}_${t}`,A,(()=>{pa(),ma(),qo(),Ka(1)}))})),io(`${ut}_${w}`).checked=1},$a=()=>{i.forEach(((e,t)=>{const o=wo(q,mt,t,e,t);ho(pt,o),uo(`${mt}_${t}`,A,(()=>{ga(t),ma(),qo(),Ka(1)}))})),io(`${mt}_${S}`).checked=1},ha=()=>{d.forEach(((e,t)=>{const o=wo(q,ft,t,e,t);ho(gt,o),uo(`${ft}_${t}`,A,(()=>{ya(t),ma(),qo(),Ka(1)}))})),io(`${ft}_${S}`).checked=1},ua=()=>{$.forEach(((e,t)=>{const o=wo(q,vt,t,e,t);ho(yt,o),uo(`${vt}_${t}`,A,(()=>{Sa(t),ma(),qo(),Ka(1)}))})),io(`${vt}_${S}`).checked=1},ma=()=>{Ss(),fa()},fa=()=>{let e=k;Vt.p.values.forEach(((t,o)=>{const a=t.length>2?t.slice(0,t.length).join(", "):2===t.length?` ${t[1]}`:k;let s="";var l;t[0]!=h[2]&&(s=`Cargas académicas ${t[0]}${a}`),t[0]==h[2]&&(s=`${l=t[0],`${l[0].toUpperCase()}${l.substring(1).toLowerCase()}`} las cargas académicas ${a}`),s+=`: <spam id="${_t}_${o}"></spam>`;const c=wo(E,wt,o,s,o);e+=c}));mo(xt,`<a name="${U}"></a><h6>5 - Selecione una métrica.</h6><p class="form-check-label">Mostrar seleccionado:</p><div class="form-check">${e}</div></div>`),Vt.p.values&&(io(`${wt}_${S}`).checked=1),Vt.p.values.forEach(((e,t)=>{uo(`${wt}_${t}`,A,(()=>{ts(1)}))}))},va=e=>{const t=`${wo(E,kt,0,s[0],0)}${wo(E,kt,1,s[1],1)}${yo(Tt)}`;mo(Ct,t),uo(`${kt}_${S}`,A,(()=>{ba(0)})),uo(`${kt}_${w}`,A,(()=>{ba(1)})),io(`${kt}_${e}`).checked=1},ba=e=>{if(!e)return fo(At),void va(0);let t=k;Ft.S.forEach((e=>{t+=`<tr><td style="background-color: ${e[0]}">${e[1]}</td></tr>`}));mo(At,`<table class="responsive"><thead><tr><th scope="col">Colores para las sesiones de las asignaturas</th></tr></thead><tbody>${t}</tbody></table>`),va(1);oa().forEach(((e,t)=>{let o="";Ft.S.forEach(((e,a)=>{o+=`<option style="background-color: ${e[0]}" ${a===t?"selected":k}>${e[1]}</option>`}));ho(Tt,`<label class="form-check-label">Asignatura <br>${e}</label><select class="form-select" id="${jt}_${t}">${o}</select>`)}))},pa=()=>{io(`${ut}_${w}`).checked||io(`${ut}_${_}`).checked||(io(`${ut}_${w}`).checked=1)},ga=e=>{if(io(`${mt}_${w}`).checked||io(`${mt}_${_}`).checked)return 0===e?(io(`${mt}_${S}`).checked=1,io(`${mt}_${w}`).checked=0,void(io(`${mt}_${_}`).checked=0)):void(1!==e&&2!==e||(io(`${mt}_${S}`).checked=0));io(`${mt}_${S}`).checked=1},ya=e=>{if(io(`${ft}_${w}`).checked||io(`${ft}_${_}`).checked)return 0===e?(io(`${ft}_${S}`).checked=1,io(`${ft}_${w}`).checked=0,void(io(`${ft}_${_}`).checked=0)):void(1!==e&&2!==e||(io(`${ft}_${S}`).checked=0));io(`${ft}_${S}`).checked=1},Sa=e=>{if(io(`${vt}_${w}`).checked||io(`${vt}_${_}`).checked){if(0===e)return io(`${vt}_${S}`).checked=1,io(`${vt}_${w}`).checked=0,io(`${vt}_${_}`).checked=0,void fo(St);if(1!==e){if(2===e){let e=[];if(e=oa(),0===e.length)throw alert(ye),io(`${vt}_${w}`).checked&&(io(`${vt}_${_}`).checked=0),io(`${vt}_${w}`).checked||(io(`${vt}_${S}`).checked=1),new Error(ye);return io(`${vt}_${S}`).checked=0,void wa(e)}}else io(`${vt}_${S}`).checked=0}else io(`${vt}_${S}`).checked=1},wa=e=>{if(io(`${vt}_${_}`).checked){let t=k;e.forEach(((o,a)=>t+=`<option value=${a+1} ${e.length===a?"selected":k}>${a+1}</option >`));mo(St,`<select class="form-select" id="${Pt}">${t}</select>`),uo(Pt,A,(()=>{qo(),Ka(1)}))}else fo(St)},_a=()=>{let e=[],t=[],o=[];const a=[];Vt._=1,to.get().forEach((s=>{e=structuredClone(Jt),e[Wt.get()]=[s],t=Fa(Zt.get(),e),o=no(t,ee),a.push(o.length)})),Vt._=a.reduce(((e,t)=>e*t))},Ca=e=>Array.from(io(e).selectedOptions).map((e=>e.textContent)),xa=e=>{const t=Ca(Qe),o=Ca(Je),a=Ca(Ye),s=Ca(Ke);to.set(Ca(et));const l=Ca(ot);Jt[F]=t,Jt[Y]=e>=2?o:[],Jt[J]=e>=3?a:[],Jt[Z]=e>=4?s:[],Jt[Wt.get()]=e>=5?to.get():[],Jt[ee]=e>=6&&e<=9?l:[],Kt.set(Fa(Zt.get(),Jt))},ka=e=>{const t=$o(e);for(let e=0;e<t.length;e++)if(t[e].checked)return e},Aa=e=>{const t=$o(e),o=[];for(let e=0;e<t.length;e++)t[e].checked&&o.push(e);return o},Ma=e=>parseInt($o(e)[ka(e)].value),Da=()=>{Ft.selected=[];const e=oa();for(let t=0;t<e.length;t++)Ft.selected.push(io(`${jt}_${t}`).selectedIndex)},Ea=()=>{za({C:1,k:0,A:ka(ct)})},qa=e=>{document.body.style.cursor=e},za=({C:e,k:t,A:o})=>{if(qa(O),(()=>{if(!Ha())return alert(ge),0;const{_:e}=Vt;return 0===e?(alert(Se),0):e>43e5?(alert(`El sistema por el momento no soporta mas de ${Qs(e)} busquedas, se esta trabajando para ello.`),0):1})()){if(Vt.l===p&&(Va(),ns(),ls(),cs()),Ya()&&(ps(),gs(),rs(),ys()),Ya()&&e){const e=ka(wt),t=Ma(ht);ws(e,t),_s(e,t),xs(1)}os(),Cs()&&(e&&!t&&(Is(0),js(0),ka(nt)?(Ts(),Gs(0)):(Is(1),js(1),zs(),Hs(),zo(),Us(),Os(),Gs(1)),Fs(3),Vs(1)),!e&&t&&(Gs(0),Hs(),zo(),Es(),Fs(4)),o?(Zs(),Rs()):Gs(0),qa(T))}},La=e=>e.map((([,e,t])=>[e,t,"","","","","",""])),Na=()=>[...new Set(Zt.get().filter((e=>"A"===e[B])).map((e=>[e[ie],e[re],e[ne],e[le],e[ce],e[de],e[B]])).filter(((e,t,o)=>{const a=e[2]+"|"+e[3];return o.findIndex((e=>e[2]+"|"+e[3]===a))===t})).sort(((e,t)=>e[3]-t[3])))],Ra=(e,t,o,a,s)=>{let l=jo(Pa(e));o&&(l+=y);const c=new Date(l),r=`${c.getHours()}:${Pa(c.getMinutes())}:${Pa(c.getSeconds())}`,n=l/y;l+=y*t;const i=new Date(l),d=`${i.getHours()}:${Pa(i.getMinutes())}:${Pa(i.getSeconds())}`,$=l/y,h=eo.get()(t),{i:u}=Oo(t,h),m=[t,r,d,n,$,u,a];return"C"===a&&m.push(s),m},Ia=e=>{const t=eo.get()()[0];for(let o=0;o<e.length;o++){const a=e[o],s=`${a[1]} - ${a[2]}`,l=a[5];if(l>1){let c=a[1];for(let a=0;a<l;a++){const l=Ra(c,t,a>0,"C",s);c=l[2],0==a&&e.splice(o,1);Oa(l,e,3,4)||(e.splice(o,0,l),o++)}o--}}ja(e)},ja=e=>{e.sort(((e,t)=>e[3]-t[3]||e[4]-t[4]))},Pa=e=>{const t=e.toString();return 1===t.length||7===t.length?"0"+t:t},Oa=(e,t,o,a)=>t.some((t=>t[o]===e[o]&&t[a]===e[a])),Ta=e=>{for(let t=1;t<e.length;t++){const o=e[t],a=e[t-1],s=o[3]-1-(a[4]+1);if(s>9)throw new Error("Se detecta un recreo mayor a 9 minutos");if(s>-1){const o=a[2],l=Ra(o,s,!0,"CR");e.splice(t,0,l),t++}}},Ua=e=>{e.slice(1).forEach(((t,o)=>{const a=e[o];t[3]-1!==a[4]&&console.log(" V:",`El elemento ${o+1} no es consecutivo con el anterior`,t)}))},Ba=()=>{ao.set((()=>{const e=Na();return Ia(e),Ta(e),Ua(e),La(e)})())},Ha=()=>Jt[F].length>0&&Jt[Z].length>0&&Jt[Wt.get()].length>0,Va=()=>{oo.set([]);const e=Wt.get(),t=ao.get(),o=oo.get(),a=Jt[e],s=a.length,l=[],c=[];for(let r=0;r<s;r++){const s={"Sección":[],Docente:k,Sala:k};s[e]=[a[r]];const n={M:s[e],D:[]};o.push(n);const i=o.length-1,d=Fa(Kt.get(),s),$=no(d,ee);for(let e=0;e<$.length;e++){const a=$[e];s[ee]=[a];const n=Fa(Kt.get(),s),d={q:s[ee],L:no(n,oe).join(", "),N:[],R:[],I:[[],[],[],[],[],[]]};o[i].D.push(d);const h=o[i].D,u=h[h.length-1],{R:m,I:f,N:p}=u;let g=[],y=[];if(g=Array.from(new Set(n.map((e=>e[te])))).map((e=>({Horario:e,"Día":n.find((t=>t[te]===e)).Día}))),g.length<=0&&alert(pe),2017!==lo.get()&&(y=g),2017===lo.get()){const t=g[0][te].split(C),a=g[0].Día.split(C);if(t.length===a.length)for(let e=0;e<t.length;e++)y.push({Horario:t[e],"Día":a[e]});else t.length<a.length?alert(`A la columna Horario de la sección ${o[r].D[e].q} le falta un horario.`):a.length<t.length&&alert(`A la columna Día de la sección ${o[r].D[e].q} le falta un día.`)}for(let a=0;a<y.length;a++){let s=3,c=1;const n=y[a],i=n[se],d=n[te];"En linea"!==i&&"Online"!==d||(s-=1,c-=1);const $=co.get()?i:d.split(" ")[0],h=d.split(" "),u={j:$,P:h[s],O:h[c],T:0,U:[]},{O:m,P:f,U:g}=u,S=co.get()?v.indexOf($):b.indexOf($);-1===S&&l.push(o[r].D[e].q),u.T=S;for(let e=0;e<t.length;e++){const o=t[e];if(o[0]===m){if(g.push(e),o[1]===f)break}else{if(o[1]===f){g.push(e);break}g.length>0&&g.push(e)}}p.push(u)}for(let e=0;e<p.length;e++){const{U:o,T:s,O:l,P:r}=p[e],n=o.map((e=>e+t.length*s));if(-1!==s)for(let o=0;o<p.length;o++){const{U:s,T:i,O:d,P:$}=p[o],h=s.map((e=>e+t.length*i));if(-1===i)continue;const u=new Set(n),m=new Set(h),f=u.difference(m).size>0,v=u.isSubsetOf(m),b=m.isSubsetOf(u);f&&v&&(c.push(`${a} ${l} ${r}`),p.splice(e,1)),f&&b&&(c.push(`${a} ${d} ${$}`),p.splice(o,1))}}for(let e=0;e<p.length;e++){const{U:o,T:a}=p[e];for(let e=0;e<o.length;e++){const s=o[e],l=t.length*a+s;m.push(l),f[a].push(s)}}}}l.length>0&&Qa(1,0,l),c.length>0&&Qa(1,1,c)},Ga=e=>'<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 16 16"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" /></symbol></svg><div class="alert alert-warning alert-dismissible fade show" role="alert"><svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Warning:"><use xlink:href="#exclamation-triangle-fill" /></svg>'+e+'<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>',Qa=(e,t,o=[])=>{const a=[Ie,je];if(!e)return void mo(a[t],k);if(!Array.isArray(o)||0===o.length)return void mo(a[t],Ga("No hay información para mostrar."));const s=[`<strong>Un día no asignado en el excel para ${o.length>1?"las secciones: ":"la sección: "}</strong>${o.join(" - ")}. Revise en la columna "Día" del Excel su correspondiente valor, tiene que ser con nombres de Lunes a Sábado. Al faltarle un día a la sección no se mostrará en la tabla, pero sí se considera en las combinaciones de la lista.`,`<strong>${o.length>1?"Las secciones: ":"La sección: "}</strong>${o.join(" - ")}${o.length>1?" tienen horarios duplicados y por ello se han eliminado.":" tiene un horario duplicado y por ello se ha eliminado."}`];mo(a[t],Ga(s[t]))},Fa=(e,t)=>e.filter((e=>Object.keys(t).every((o=>Array.isArray(t[o])&&t[o].some((t=>"string"==typeof e[o]&&e[o]===t))||0===t[o].length)))),Ja=()=>Xa()?6:5,Xa=()=>Jt[Y].some((e=>"Vespertino"===e||"Diurno y Vespertino"===e)),Ya=()=>Ht.order||Ht.B||Ht.H||Ht.subject,Za=e=>{Ht.order=e},Ka=e=>{Ht.B=e},Wa=e=>{Ht.H=e},es=e=>{Ht.subject=e},ts=e=>{Ht[wt]=e},os=()=>{Za(0),Ka(0),ts(0),Wa(0),es(0)},as=()=>oo.get().map((e=>e.D.length)),ss=(e,t)=>{const o={},a=((e,t)=>{const o=[];for(let a=t.length-1;a>=0;a--){const s=t[a],l=e%s;o.unshift(l);const c=e/s;e=Math.floor(c)}return o})(e,t);o.V=a;const{R:s,I:l}=(e=>{const t=[],o=[];for(let a=0;a<e.length;a++){const s=e[a],l=oo.get()[a].D[s],c=l.R,r=l.I;t.push(c),o.push(r)}return{R:t,I:o}})(a);return o.R=s,o.I=l,o},ls=()=>{Vt.o=[]},cs=()=>{const e=as();for(let t=0;t<Vt._;t++){const o=ss(t,e);Vt.o.push(o)}},rs=()=>{const e=as();Vt.o.forEach(((t,o)=>{const a=ss(o,e),s=Vt.o[o],l=Object.assign(s,a);Vt.o[o]=l}))},ns=()=>{Vt.G=[]},is=e=>{const t=e.R.flat();e[ut]=t.length===[...new Set(t)].length?1:0},ds=e=>{const t=[[],[],[],[],[],[]],o=[[],[],[],[],[],[]],a=[0,0,0,0,0,0];for(let s=0;s<t.length;s++){const l=e.I;for(let e=0;e<l.length;e++)if(l[e][s].length>0){const c=[];for(let t=0;t<l[e][s].length;t++)o[s].includes(l[e][s][t])||c.push(l[e][s][t]),o[s].push(l[e][s][t]);t[s]=t[s].concat([c.sort(((e,t)=>e-t))]),a[s]++}}for(let e=0;e<t.length;e++){o[e].sort(((e,t)=>e-t));for(let o=0;o<t[e].length;o++)t[e]=t[e].sort(((e,t)=>e[e.length-1]-t[0]))}e.F=t,e.J=o,e.X=a},$s=e=>{let t=0;const o=(()=>{if(null===io(Pt))return to.get().length>4?Xa()?to.get().length:4:to.get().length;return io(Pt).value})();for(let a=0;a<e.X.length;a++)if(e.X[a]>o){t=1;break}e[vt]=t},hs=e=>{e.Y=e.I.flat(2).reduce(((e,t)=>e+t),0)},us=e=>{const t=[],o=[0,0,0,0,0,0],a=[0,0,0,0,0,0];for(let a=0;a<e.F.length;a++)if(0!=e.F[a].length){t.push(a);const s=e.F[a];for(let e=1;e<s.length;e++)s[e-1][s[e-1].length-1]!==s[e][0]-1&&o[a]++}const{J:s}=e;for(let e=0;e<s.length;e++){const t=s[e],o=t.length,l=t[0],c=t[o-1]-l+1-o|0;a[e]=c}e.Z=t,e.K=o,e.W=a},ms=e=>{e[mt]=e.Z.length<Ja()?1:0},fs=e=>{e.ee=e.W.reduce(((e,t)=>e+t),0)},vs=e=>{let t=0;for(let o=0;o<e.Z.length;o++)e.K[e.Z[o]]===e.F[e.Z[o]].length-1&&t++;e[ft]=t===e.Z.length?1:0},bs=e=>{delete e.V,delete e.I,delete e.R,delete e.F,delete e.J,delete e.X,delete e.Z,delete e.K,delete e.W,delete e.te},ps=()=>{so.set([])},gs=()=>{const e=ka(st),t=Vt.p.oe,o=so.get();Vt.l===p&&o.push(is),o.push(ds),(t[vt].includes(1)||t[vt].includes(2))&&o.push($s),1!==e&&2!==e||o.push(hs),(t[mt].includes(1)||t[mt].includes(2)||3===e||4===e||t[ft].includes(1)||t[ft].includes(2))&&o.push(us),(t[mt].includes(1)||t[mt].includes(2))&&o.push(ms),3!==e&&4!==e||o.push(fs),(t[ft].includes(1)||t[ft].includes(2))&&o.push(vs),o.push(bs)},ys=()=>{Vt.o.forEach(((e,t)=>{var o;o=t,Vt.G.push(o),so.get().forEach((e=>e(Vt.o[t])))})),Ht.order&&(()=>{const e=ka(st);if(0===e)return;const t=Vt.G;1!==e?2!==e?3!==e?4!==e||t.sort(((e,t)=>Vt.o[e].ee<Vt.o[t].ee?-1:Vt.o[e].ee>Vt.o[t].ee?1:0)):t.sort(((e,t)=>Vt.o[e].ee>Vt.o[t].ee?-1:Vt.o[e].ee<Vt.o[t].ee?1:0)):t.sort(((e,t)=>Vt.o[e].Y>Vt.o[t].Y?-1:Vt.o[e].Y<Vt.o[t].Y?1:0)):t.sort(((e,t)=>Vt.o[e].Y<Vt.o[t].Y?-1:Vt.o[e].Y>Vt.o[t].Y?1:0))})(),Vt.o.forEach(((e,t)=>{var o;delete(o=t).ee,delete o.Y}))},Ss=()=>{Vt.p={},Vt.p.ae=[],Vt.p.se=[],Vt.p.values=[],Vt.le={},Vt.p.oe={};const e=Vt.p.oe;e[ut]=Aa(ut),e[mt]=Aa(mt),e[ft]=Aa(ft),e[vt]=Aa(vt),e[ut].forEach((t=>{const o=[ut,t],a="S"+ks(t);Vt.p.ae.push(a),Vt.p.se.push([o]),Vt.p.values.push([h[t]]),Vt.le[a]=p,e[mt].forEach((e=>{const s=e-1;if(-1!==s){const e="SFD"+ks(s),l=`${a}-${e}`;Vt.p.ae.push(l),Vt.p.se.push([o,[mt,s]]),Vt.p.values.push([h[t],u[s]]),Vt.le[l]=p}})),e[ft].forEach((e=>{const s=e-1;if(-1!==s){const e="MOF"+ks(s),l=`${a}-${e}`;Vt.p.ae.push(l),Vt.p.se.push([o,[ft,s]]),Vt.p.values.push([h[t],m[s]]),Vt.le[l]=p}})),e[vt].forEach((e=>{const s=e-1;if(-1!==s){const e="SOM"+ks(s),l=`${a}-${e}`;Vt.p.ae.push(l),Vt.p.se.push([o,[vt,s]]),Vt.p.values.push([h[t],f[s]]),Vt.le[l]=p}}))}))},ws=(e,t)=>{Vt.p.ae.forEach(((o,a)=>{3===t&&e!==a&&(Vt.le[o]=p),(t>1&&e===a||1===t)&&(Vt.le[o]=[])}))},_s=(e,t)=>{Vt.G.forEach((o=>{const a=Vt.o[o];Vt.p.se.forEach(((s,l)=>{if(e==l&&Vt.le[Vt.p.ae[l]]!==p&&(2==t||3==t)||1===t){let e=1;s.forEach((t=>{2!==t[1]&&(a[t[0]]===t[1]||(e=0))})),e&&Vt.le[Vt.p.ae[l]].push(o)}}))}))},Cs=()=>Ms()===p?1:0===Ds()?(alert(we),Js(),null!==io(Mt)&&fo(Mt),0):1,xs=e=>{Vt.p.ae.forEach(((t,o)=>{const a=e?Vt.le[Vt.p.ae[o]]?Qs(Vt.le[Vt.p.ae[o]].length):"?":k;mo(`${_t}_${o}`,a)}))},ks=e=>{if(1===e){return"_T"}if(0===e){return"_F"}if(2===e){return"_A"}},As=e=>({...ss(e,as()),...Vt.o[e]}),Ms=()=>Vt.le[Vt.p.ae[Aa(wt)]],Ds=()=>Ms().length,Es=()=>{const e=io(Mt);if(null==e)return alert(ke),0;const t=Array.from(e.selectedOptions).map((e=>parseInt(e.value)));return 0==t.length?(alert(Ae),0):(Vt.l=t,1)},qs=e=>{const t=Math.trunc(Gt.ce/e),o=Gt.ce%e,a=[];for(let o=0;o<t;o++)a.push([o*e,o*e+e,0]);return o>0&&a.push([t*e,t*e+o,0]),a},zs=()=>{const e=parseInt(Ca(zt));Gt.ce=Ds(),Gt.re=qs(e),Gt.ce>g&&(Qt.re=qs(g))},Ls=e=>{0!==Gt.ne||e?Gt.re.length===Gt.ne+1&&e?alert(_o(I,j)):(qa(O),e?Gt.ne++:Gt.ne--,zo(),Os(),Gs(1),Gt.re[Gt.ne][2],Zs(),Us(),Rs(),qa(T)):alert(_o(R,j))},Ns=e=>{0!==Qt.ne||e?Qt.re.length===Qt.ne+1&&e?alert(_o(I,P)):(qa(O),e?Qt.ne++:Qt.ne--,Bs(),Fs(3)):alert(_o(R,P))},Rs=()=>{const e=Gt.ne!=p?`_${Gt.ne}`:k;location.hash="#"+(0===Gt.ne?`${U}`:`${Pe}${e}`)},Is=e=>{Gt.ne=e?0:p},js=e=>{Qt.ne=e?0:p},Ps=()=>{Gt.ne=io(Lt).selectedIndex},Os=()=>{const e=Gt.re[Gt.ne][0],t=Gt.re[Gt.ne][1];Gt.ie=e,Gt.de=t,Vt.l=Ms().slice(e,t)},Ts=()=>{Vt.l=Vt.o.map(((e,t)=>t))},Us=()=>{Gt.re[Gt.ne][2]=1},Bs=()=>{Qt.re[Qt.ne][2]=1},Hs=()=>{let e=k;for(let t=0;t<Gt.re.length;t++)e+=`<div id="${Pe}_${t}"></div>`;mo(`${Pe}`,e)},Vs=e=>{mo(qt,e?'<iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfaidqhUi9_qqaiSjIAhwFQrCHji_-459KmzP3uibq1d1Z1Ow/viewform?embedded=true" width="500" height="443" frameborder="0" marginheight="0" marginwidth="0">Cargando…</iframe>':k)},Gs=e=>{if(e){let e=k;for(let t=0;t<Gt.re.length;t++)e+=`<option ${Gt.ne===t?"selected":k}>${Qs(t+1)}: ${Qs(Gt.re[t][0]+1)} al lugar ${Qs(Gt.re[t][1])}</option>`;const t=`<div><h6>Rangos de cargas académicas</h6><div class="d-grid mx-auto"><spam> Total de rangos: ${Qs(Gt.re.length)}</spam><spam> Total de cargas académicas: ${Qs(Gt.ce)}</spam><spam> Rango actual: </spam><select class="form-select" aria-label="Default select example" id="${Lt}">${e}</select><div class="btn-group"><button type="button" class="btn btn-outline-primary" id="${Nt}_0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path></svg></button><button type="button" class="btn btn-outline-primary" id="${Nt}_1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/></svg></button></div></div>`;mo(Re,t),io(Re).classList.add("shadow-lg","mb-5",ko()?"bg-dark":"bg-white","rounded","flotante","col-4","col-md-2"),uo(Lt,A,(()=>{Ps(),Os(),Gs(1),Gt.re[Gt.ne][2]?alert(`Ya se ha desplegado el rango ${Gt.ne+1}.`):Zs(),Rs(),Us(),qa(T)})),uo(`${Nt}_${S}`,M,(()=>{Ls(0)})),uo(`${Nt}_${w}`,M,(()=>{Ls(1)}))}else fo(Re),io(Re).classList.remove("shadow-lg","mb-5",ko()?"bg-dark":"bg-white","rounded","flotante","col-4","col-md-2")},Qs=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".").toString(),Fs=e=>{if(1==e)return fo(Ne),fo(qe),fo(Ie),fo(je),void Fo(0);if(2==e){const e=`<h6>Métricas:</h6><div class="form-check"><p class="form-check-label">Cargas académicas a buscar: ${Qs(Vt._)}</p></div>`;return mo(qe,e),mo(Dt,e),fo(Ie),fo(je),fo(Et),void fo(Ne)}if(3!=e)if(4!=e);else{const e=`<a href="#${U}" class="btn btn-outline-primary flotante ${ko()?"bg-dark":"bg-white"}">Ir a las métricas</a>`;mo(Ne,e)}else{let e=k;Qt.re&&(e=`<div class="btn-group"><button type="button" class="btn btn-outline-primary" id="${Rt}_0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path></svg></button><button type="button" class="btn btn-outline-primary" id="${Rt}_1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/></svg></button></div>`);let t=k;Qt.re&&(t=`Rango: <text class="form-check-label">${Qt.ne+1} de ${Qt.re.length}</text>`);const o=`<a href="#${U}" class="btn btn-outline-primary flotante ${ko()?"bg-dark":"bg-white"}">Ir a las métricas</a>`;mo(Ne,o);const a=bo(Mt);mo(Et,'<h6>Números de horarios (Selección opcional)</h6><text class="form-check-label">Color azul: Cargas académicas aprobadas</text><br><text class="form-check-label">Color rojo: Cargas académicas rechazadas</text><br>'+t+"<div>"+`${a}</select><div class="margen d-grid">`+`${e}`+`<button type="button" class="btn btn-secondary" id="${It}">${xe}</button></div></div></div>`),Qt.re&&(uo(`${Rt}_${S}`,M,(()=>{Ns(0)})),uo(`${Rt}_${w}`,M,(()=>{Ns(1)}))),uo(`${It}`,M,(()=>{za({C:0,k:1,A:1})})),fo(Mt);let s=[];if(Qt.re){if(0===Qt.re.length)return console.alert(_e);s=(()=>{const e=Qt.re[Qt.ne][0],t=Qt.re[Qt.ne][1];return Qt.ie=e,Qt.de=t,Ms().slice(e,t)})()}else s=Ms();s.forEach((e=>{const t=`<option style="color:${As(e)[ut]?he:me}" value=${e}>${Qs(e+1)}</option>`;ho(Mt,t)}))}},Js=()=>{Gs(0),Xs()},Xs=()=>{fo(Pe)},Ys=e=>{const t=Gt.ne!=p?`_${Gt.ne}`:k;ho(`${Pe}${t}`,e)},Zs=()=>{const e=ka(dt),t=ka(kt);0!==e?1!==e?2!==e?3!==e?4!==e||(t?(Da(),dl()):il()):t?ll():cl():t?al():sl():t?(Da(),ol()):tl():t?(Da(),el()):Ws()},Ks=()=>{Ft.S=[["#ffdf89","Anaranjado"],["#fffdbf","Amarillo"],["#e9ffba","Verde limón"],["#defefe","Turquesa"],["#cff4fc","Celeste"],["#cfe2ff","Azúl"],["#e2d9f3","Purpura"],["#e0cffc","Indigo"],["#f7d6e6","Rosado"],["#e8ba86","Marrón"],["#d3bead","Café"],["#f8f9fa","Plomo"]]},Ws=()=>{let e=k;for(let t=0;t<Vt.l.length;t++){const o=As(Vt.l[t]);let a=structuredClone(ao.get());for(let e=0;e<o.V.length;e++){const t=oo.get()[e].D[o.V[e]];let s=t.q[0];for(let e=0;e<t.N.length;e++){const o=t.N[e];let l=o.T;for(let e=0;e<o.U.length;e++)a[o.U[e]][l+2]+=` ${s}`}}let s=k;for(let e=0;e<a.length;e++)s+=`<tr><th scope="row">${a[e][0]} - ${a[e][1]}</th><td>${a[e][2]}</td><td>${a[e][3]}</td><td>${a[e][4]}</td><td>${a[e][5]}</td><td>${a[e][6]}</td><td>${a[e][7]}</td></tr>`;const l=o[ut]?`<p style="color:${he}">Carga académica ${Qs(Vt.l[t]+1)} aprobada</p>`:`<p style="color:${me}">Carga académica ${Qs(Vt.l[t]+1)} rechazada</p>`;e+=`<div class="table-responsive"><table class="table table-bordered"><caption><h5>${l}<div class="margen"><button type="button" class="btn btn-${o[ut]?"primary":"danger"}" id="${Ot}${Vt.l[t]}" data-bs-toggle="modal" data-bs-target="#exampleModal${Vt.l[t]}">Mostrar resumen</button></div></h5></caption><thead><tr><th scope="col">Horarios</th><th scope="col">Lunes</th><th scope="col">Martes</th><th scope="col">Miércoles</th><th scope="col">Jueves</th><th scope="col">Viernes</th><th scope="col">Sábado</th></tr></thead><tbody>${s}</tbody></table></div><div class="modal fade" id="exampleModal${Vt.l[t]}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="1"><div class="modal-dialog modal-xl"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="exampleModalLabel${Vt.l[t]}">${l}</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body" id="modal${Vt.l[t]}"></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button></div></div></div></div>`}Ys(e);for(let e=0;e<Vt.l.length;e++)uo(`${Ot}${Vt.l[e]}`,M,(()=>{rl(Vt.l[e])}))},el=()=>{let e=k;for(let t=0;t<Vt.l.length;t++){const o=As(Vt.l[t]);let a=structuredClone(ao.get()),s=structuredClone(ao.get());for(let e=0;e<o.V.length;e++){const t=oo.get()[e].D[o.V[e]],l=t.q[0];for(let o=0;o<t.N.length;o++){const c=t.N[o],r=c.T;for(let t=0;t<c.U.length;t++){const o=c.U[t];s[o][r+2]=s[o][r+2].length>0?ue:Ft.S[Ft.selected[e]][0],a[o][r+2]+=` ${l}`}}}let l=k;for(let e=0;e<a.length;e++)l+=`<tr><th scope="row">${a[e][0]} - ${a[e][1]}</th><td style="background-color: ${s[e][2]}">${a[e][2]}</td><td style="background-color: ${s[e][3]}">${a[e][3]}</td><td style="background-color: ${s[e][4]}">${a[e][4]}</td><td style="background-color: ${s[e][5]}">${a[e][5]}</td><td style="background-color: ${s[e][6]}">${a[e][6]}</td><td style="background-color: ${s[e][7]}">${a[e][7]}</td></tr>`;const c=o[ut]?`<p style="color:${he}">Carga académica ${Qs(Vt.l[t]+1)} aprobada</p>`:`<p style="color:${me}">Carga académica ${Qs(Vt.l[t]+1)} rechazada</p>`;e=`<div class="table-responsive"><table class="table table-bordered"><caption><h5>${c}<div class="margen"><button type="button" class="btn btn-${o[ut]?"primary":"danger"}" id="drawResumeColor${Vt.l[t]}" data-bs-toggle="modal" data-bs-target="#exampleModal${Vt.l[t]}">Mostrar resumen</button></div></h5></caption><thead><tr><th scope="col">Horarios</th><th scope="col">Lunes</th><th scope="col">Martes</th><th scope="col">Miércoles</th><th scope="col">Jueves</th><th scope="col">Viernes</th><th scope="col">Sábado</th></tr></thead><tbody>${l}</tbody></table></div><div class="modal fade" id="exampleModal${Vt.l[t]}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="1"><div class="modal-dialog modal-xl"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="exampleModalLabel${Vt.l[t]}">${c}</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body" id="modal${Vt.l[t]}"></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button></div></div></div></div>`,Ys(e),uo(`drawResumeColor${Vt.l[t]}`,M,(()=>{nl(Vt.l[t])}))}},tl=()=>{let e=k;for(let t=0;t<Vt.l.length;t++){const o=As(Vt.l[t]);let a=k;for(let e=0;e<o.V.length;e++){let t=k;const s=o.V[e],l=oo.get()[e],c=l.M,r=l.D[s],n=r.q[0],i=r.L;for(let e=0;e<r.N.length;e++){const{j:o,O:a,P:s}=r.N[e];t+=`${o} ${a} - ${s} `}a+=`<tr><th scope="row">${c}</th><td>${n}</td><td>${i}</td><td>${t}</td></tr>`}e+=`<div class=" table-responsive"><table class="table"><caption><h5>${o[ut]?`<p style="color:${he}">Carga académica ${Qs(Vt.l[t]+1)} aprobada</p>`:`<p style="color:${me}">Carga académica ${Qs(Vt.l[t]+1)} rechazada</p>`}</h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Horario</th></tr></thead><tbody>${a}</tbody></table></div`}Ys(e)},ol=()=>{for(let e=0;e<Vt.l.length;e++){const t=As(Vt.l[e]),o=structuredClone(ao.get());let a=k;const s=[];for(let l=0;l<t.V.length;l++){let c=k;const r=oo.get()[l],{M:n,D:i}=r,d=i[t.V[l]],$=d.q[0],h=d.L;s.push(Ft.S[Ft.selected[l]][0]);for(let e=0;e<d.N.length;e++){const t=d.N[e],a=t.T;for(let e=0;e<t.U.length;e++){const c=t.U[e];o[c][a+2]!=k&&(s[o[c][a+2]]=ue,s[l]=ue),o[c][a+2]=`${l}`}c+=`${t.j} ${t.O} - ${t.P} `}a+=`<tr><th scope="row">${n}</th><td id="${Vt.l[e]}-${l}">${$}</td><td>${h}</td><td>${c}</td></tr>`}const l=t[ut]?`<p style="color:${he}">Carga académica ${Qs(Vt.l[e]+1)} aprobada</p>`:`<p style="color:${me}">Carga académica ${Qs(Vt.l[e]+1)} rechazada</p>`;Ys(`<div class=" table-responsive"><table class="table"><caption><h5>${l}</h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Horario</th></tr></thead><tbody>${a}</tbody></table></div`);for(let t=0;t<s.length;t++)io(`${Vt.l[e]}-${t}`).style.background=s[t]}},al=()=>{alert("No se ha implementado la lista en tabla en color.")},sl=()=>{let e=k;for(let t=0;t<Vt.l.length;t++){const o=As(Vt.l[t]);let a=" Asignatura - Sección - Días y horas<br>";for(let e=0;e<o.V.length;e++){let t=k;const s=oo.get()[e],l=s.M,c=s.D[o.V[e]],r=c.q[0];for(let e=0;e<c.N.length;e++){const{j:o,O:a,P:s}=c.N[e];t+=`${o}-${a} - ${s} `}a+=`${l} - ${r} - ${t}<br>`}e+=`${o[ut]?`<p style="color:${he}">Horario ${Qs(Vt.l[t]+1)} aprobada</p>`:`<p style="color:${me}">Horario ${Qs(Vt.l[t]+1)} rechazada</p>`}${a}<br>`}Ys(e)},ll=()=>{let e=k;for(let t=0;t<Vt.l.length;t++){const o=As(Vt.l[t]);let a=k;for(let e=0;e<to.get().length;e++){a+=`${oo.get()[e].D[o.V[e]].q[0]} `}e+=`${o[ut]?`<p style="color:${he}">Carga académica ${Qs(Vt.l[t]+1)} aprobada</p>`:`<p style="color:${me}">Carga académica ${Qs(Vt.l[t]+1)} rechazada</p>`}: ${a}<br>`}Ys(e)},cl=()=>{let e=k;for(let t=0;t<Vt.l.length;t++){const o=As(Vt.l[t]);let a=k;for(let e=0;e<to.get().length;e++){a+=`${oo.get()[e].D[o.V[e]].q[0]} `}e+=`Carga académica ${Qs(Vt.l[t]+1)}: ${a}<br>`}Ys(e)},rl=e=>{const t=As(e);let o=k;for(let e=0;e<t.V.length;e++){const a=oo.get()[e],s=a.M,l=a.D[t.V[e]],c=l.q[0],r=l.L;let n=k;for(let e=0;e<l.N.length;e++){const{j:t,O:o,P:a}=l.N[e];n+=`${t} ${o} - ${a} `}o+=`<tr><th scope="row">${s}</th><td>${c}</td><td>${r}</td><td>${n}</td></tr>`}const a=t[ut]?`<p style="color:${he}">Carga académica ${Qs(e+1)} aprobada</p>`:`<p style="color:${me}">Carga académica ${Qs(e+1)} rechazada</p>`;mo(`modal${e}`,`<div class=" table-responsive"><table class="table"><caption><h5>${a}</h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Horario</th></tr></thead><tbody>${o}</tbody></table></div`)},nl=e=>{const t=As(e),o=structuredClone(ao.get());let a=k;const s=[];for(let l=0;l<t.V.length;l++){let c=k;const{M:r,D:n}=oo.get()[l],{q:i,L:d,N:$}=n[t.V[l]],h=i[0];s.push(Ft.S[Ft.selected[l]][0]);for(let e=0;e<$.length;e++){const{T:t,U:a,j:r,O:n,P:i}=$[e],d=t;for(let e=0;e<a.length;e++){const t=a[e];o[t][d+2]!=k&&(s[o[t][d+2]]=ue,s[l]=ue),o[t][d+2]=`${l}`}c+=`${r} ${n||"?"} - ${i||"?"} `}a+=`<tr><th scope="row">${r}</th><td id="${e+1}-${l}">${h}</td><td>${d}</td><td>${c}</td></tr>`}const l=t[ut]?`<p style="color:${he}">Carga académica ${Qs(e+1)} aprobada</p>`:`<p style="color:${me}">Carga académica ${Qs(e+1)} rechazada</p>`;mo(`modal${e}`,`<div class=" table-responsive"><table class="table"><caption><h5>${l}</h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Horario</th></tr></thead><tbody>${a}</tbody></table></div`);for(let t=0;t<s.length;t++)io(`${e+1}-${t}`).style.background=s[t]},il=()=>{let e=k;const t=oo.get();for(let o=0;o<t.length;o++){const{M:a,D:s}=t[o];for(let t=0;t<s.length;t++){const{q:o,L:l,N:c}=s[t];let r=k;const n=o[0];for(let e=0;e<c.length;e++){const{j:t,O:o,P:a}=c[e];r+=`${t} ${o} - ${a} `}e+=`<tr><th scope="row">${a}</th><td>${n}</td><td>${l}</td><td>${r}</td></tr>`}}Ys(`<div class=" table-responsive"><table class="table"><caption><h5><p style="color:${he}">Todas las secciones en una carga académica</p></h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Carga académica</th></tr></thead><tbody>${e}</tbody></table></div`)},dl=()=>{let e=k;const t=[],o=oo.get();for(let a=0;a<o.length;a++){const{M:s,D:l}=o[a];t.push(Ft.S[Ft.selected[a]][0]);for(let t=0;t<l.length;t++){const{q:o,L:c,N:r}=l[t];let n=k;const i=o[0];for(let e=0;e<r.length;e++){const{j:t,O:o,P:a}=r[e];n+=`${t} ${o||"?"} - ${a||"?"} `}e+=`<tr><th scope="row">${s}</th><td name="_${a}">${i}</td><td>${c}</td><td>${n}</td></tr>`}}Ys(`<div class=" table-responsive"><table class="table"><caption><h5><p style="color:${he}">Todas las secciones en una carga académica</p></h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Carga académica</th></tr></thead><tbody>${e}</tbody></table></div`);for(let e=0;e<t.length;e++)$o(`_${e}`).forEach((o=>o.style.background=t[e]))};